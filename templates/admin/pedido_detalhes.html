{% extends "base.html" %}

{% block title %}Lume - Administração - Pedido #{{ pedido.id }}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="mb-6">
        <a href="{{ url_for('admin_pedidos') }}" class="texto-font text-[#C9A24B] hover:text-[#B8923A] transition">
            ← Voltar para Pedidos
        </a>
    </div>

    <h1 class="titulo-font text-3xl font-bold text-white mb-8">Pedido #{{ pedido.id }}</h1>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div class="bg-[#383732] border border-[#C9A24B] rounded-lg p-6">
            <h2 class="titulo-font text-2xl font-bold text-white mb-6">Informações do Pedido</h2>
            
            <div class="space-y-4 mb-6">
                <div>
                    <p class="texto-font text-gray-300 text-sm">Cliente</p>
                    <p class="texto-font text-white font-semibold">{{ pedido.usuario.nome }}</p>
                </div>
                <div>
                    <p class="texto-font text-gray-300 text-sm">Email</p>
                    <p class="texto-font text-white">{{ pedido.usuario.email }}</p>
                </div>
                <div>
                    <p class="texto-font text-gray-300 text-sm">Telefone</p>
                    <p class="texto-font text-white">{{ pedido.usuario.telefone or 'N/A' }}</p>
                </div>
                <div>
                    <p class="texto-font text-gray-300 text-sm">Data do Pedido</p>
                    <p class="texto-font text-white">{{ pedido.created_at.strftime('%d/%m/%Y %H:%M') }}</p>
                </div>
                <div>
                    <p class="texto-font text-gray-300 text-sm">Método de Pagamento</p>
                    <p class="texto-font text-white capitalize">{{ pedido.metodo_pagamento or 'N/A' }}</p>
                </div>
                <div>
                    <p class="texto-font text-gray-300 text-sm">Total</p>
                    <p class="texto-font text-[#C9A24B] text-2xl font-bold">R$ {{ "%.2f"|format(pedido.total) }}</p>
                </div>
            </div>

            <div class="border-t border-[#C9A24B] pt-6">
                <h3 class="titulo-font text-xl font-bold text-white mb-4">Alterar Status</h3>
                <form method="POST" action="{{ url_for('admin_atualizar_status', pedido_id=pedido.id) }}">
                    <select name="status" class="w-full px-4 py-2 bg-[#383732] border border-[#C9A24B] rounded text-white focus:outline-none focus:border-[#B8923A] mb-4">
                        <option value="pendente" {% if pedido.status == 'pendente' %}selected{% endif %}>Pendente</option>
                        <option value="processando" {% if pedido.status == 'processando' %}selected{% endif %}>Processando</option>
                        <option value="enviado" {% if pedido.status == 'enviado' %}selected{% endif %}>Enviado</option>
                        <option value="entregue" {% if pedido.status == 'entregue' %}selected{% endif %}>Entregue</option>
                        <option value="cancelado" {% if pedido.status == 'cancelado' %}selected{% endif %}>Cancelado</option>
                    </select>
                    <button type="submit" class="w-full bg-[#C9A24B] text-[#383732] px-4 py-2 rounded hover:bg-[#B8923A] transition texto-font font-semibold">
                        Atualizar Status
                    </button>
                </form>
            </div>
        </div>

        <div class="bg-[#383732] border border-[#C9A24B] rounded-lg p-6">
            <h2 class="titulo-font text-2xl font-bold text-white mb-6">Itens do Pedido</h2>
            
            <div class="space-y-4">
                {% for item in pedido.itens %}
                <div class="border-b border-[#C9A24B] pb-4">
                    <p class="texto-font text-white font-semibold mb-2">{{ item.produto.nome }}</p>
                    <div class="texto-font text-gray-300 text-sm space-y-1">
                        <p>Quantidade: {{ item.quantidade }}</p>
                        <p>Tamanho: {{ item.tamanho }}</p>
                        <p>Material: {{ item.material }}</p>
                        <p>Pedra: {{ item.pedra }}</p>
                        <p class="text-[#C9A24B] font-semibold">Subtotal: R$ {{ "%.2f"|format(item.subtotal) }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="mt-6 pt-6 border-t border-[#C9A24B]">
                <div class="flex justify-between items-center">
                    <span class="titulo-font text-xl font-bold text-white">Total:</span>
                    <span class="texto-font text-[#C9A24B] text-2xl font-bold">R$ {{ "%.2f"|format(pedido.total) }}</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

